\documentclass{article}
\usepackage{../public/pgf-umlcd-f}
%xeCJK
\usepackage[BoldFont,SlantFont,CJKchecksingle]{xeCJK}
\setCJKmainfont[BoldFont=SimHei,SlantedFont=KaiTi]{SimSun}

\begin{document}
\section{Common Layer}
\begin{tikzpicture}
\begin{class}{Station}{0,0}
\attribute{- m\_name : string}
\attribute{- m\_x : double}
\attribute{- m\_y : double}
\operation{+ set\_Name(name:string) : void}
\operation{+ get\_Name() : string}
\operation{+ set\_x(x:double) : void}
\operation{+ get\_x() : double}
\operation{+ set\_y(y:double) : void}
\operation{+ get\_y() : double}
\end{class}
\begin{class}[text width=6cm]{BusRoute}{0,-7}
\attribute{- m\_Number : int}
\attribute{- m\_BusStops : vector<Station>}
\operation{+ get\_BusRoute() : vector<Station>}
\operation{+ Clear() : void}
\operation{+ Add(s:Station) : void}
\end{class}
\begin{class}[text width=7cm]{RouteSet}{0,-12}
\attribute{- m\_Number: int}
\attribute{- m\_BusLines : vector<BusRoute>}
\operation{+ get\_BusLine() : vector<BusRoute>}
\operation{+ Add(b:BusRoute) : void}
\operation{+ Clear() : void}
\end{class}
\composition{BusRoute}{}{}{Station}
\composition{RouteSet}{}{}{BusRoute}
\begin{class}{TwoStrings}{7,0}
\attribute{- m\_s1 : string}
\attribute{- m\_s2 : string}
\operation{+ get\_S1() : string}
\operation{+ get\_S2() : string}
\operation{+ set\_S1(str:string) : void}
\operation{+ set\_S2(str:string) : void}
\end{class}
\end{tikzpicture}
\newpage

\section{App Layer}
\begin{tikzpicture}
\begin{class}{BusApp}{0,0}
\attribute{- m\_wndMain : MainWindow}
\attribute{- m\_spViewModel : BusViewModel}
\operation{+ Init() : bool}
\operation{+ Show() : void}
\end{class}
\end{tikzpicture}
\newpage

\section{Window Layer}
\begin{tikzpicture}
\begin{class}{CWindowImpl}{0,0}
\end{class}
\begin{class}[text width=8cm]{MainWindow}{0,-5}
\inherit{CWindowImpl}
\attribute{+ m\_editStart}
\attribute{+ m\_editStop}
\attribute{+ m\_btnQuery : CButton}
\attribute{+ m\_lblCityName : BusLabel}
\attribute{+ m\_lblStopNumber : BusLabel}
\attribute{- m\_cmdQuery : ICommandBase}
\attribute{- m\_sinkProperty : MainWindowPropertySink}
\attribute{- m\_sinkCommand : MainWindowCommandSink}
\operation{+ set\_QueryCommand(cmd:<ICommandBase>) : void}
\operation{+ get\_PropertySink() : IPropertyNotification}
\operation{+ get\_CommandSink() : ICommandNotification}
\end{class}
\begin{class}{MainWindowPropertySink}{0,-13}\end{class}
\begin{class}{MainWindowCommandSink}{7,-13}\end{class}
\end{tikzpicture}
\newpage

\section{View Layer}
\begin{tikzpicture}
\begin{class}{BusLabel}{0,0}
\attribute{- m\_Name : string}
\operation{+ set\_Name(sp:<std::string>) : void}
\operation{+ Update() :void}
\end{class}
\end{tikzpicture}
\newpage

\section{ViewModel Layer}
\begin{tikzpicture}
\begin{class}[text width=7cm]{BusViewModel}{0,0}
\attribute{- m\_BusModel : BusDataModel}
\attribute{- m\_StopNumber : string}
\attribute{- m\_cmdQuery : QueryCommand}
\attribute{- m\_sink : BusViewModelSink}
\operation{+ SetModel(model:<BusDataModel>) : void}
\operation{+ get\_StopNumber() : string}
\operation{+ get\_CityName() : string}
\operation{+ get\_QueryCommand() : ICommandBase}
\operation{+ SetStopNumber(number:int) : void}
\operation{+ Query(ss:string,es:string) : bool}
\end{class}
\begin{class}{QueryCommand}{0,-10}\end{class}
\begin{class}{BusViewModelSink}{0,-15}\end{class}
\end{tikzpicture}
\newpage

\section{Model Layer}
\begin{tikzpicture}
\begin{class}{BusDataModel}{0,0}\end{class}
\end{tikzpicture}
\end{document}
